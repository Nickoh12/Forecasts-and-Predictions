# Forecasts-and-Predictions

<div class="paragraph">Congratulations! You’ve completed the section on making predictions. It’s time to apply the knowledge and skills you’ve acquired to a project: a real-life analytical case study that you’ll complete on your own.</div><div class="paragraph">When you finish the project, send your work to the project reviewer for assessment. They’ll give you feedback within 24 hours. Use the feedback to make changes, then send the new version back to the project reviewer.</div><div class="paragraph">You might get further feedback on the new version. This is completely normal. It’s not uncommon to go through several cycles of feedback and revision.</div><div class="paragraph">Your project will be considered complete once the project reviewer approves it. </div><h1>Project description</h1><div class="paragraph">The gym chain Model Fitness is developing a customer interaction strategy based on analytical data. </div><div class="paragraph">One of the most common problems gyms and other services face is customer churn. How do you know if a customer is no longer with you? You can calculate churn based on people who get rid of their accounts or don't renew their contracts. However, sometimes it's not obvious that a client has left: they may walk out on tiptoes.</div><div class="paragraph">Churn indicators vary from field to field. If a user buys from an online store rarely but regularly, you can't say they're a runaway. But if for two weeks they haven't opened a channel that's updated daily, that's a reason to worry: your follower might have gotten bored and left you. </div><div class="paragraph">For a gym, it makes sense to say a customer has left if they don't come for a month. Of course, it's possible they're in Cancun and will resume their visits when they return, but's that's not a typical case. Usually, if a customer joins, comes a few times, then disappears, they're unlikely to come back. </div><div class="paragraph">In order to fight churn, Model Fitness has digitized a number of its customer profiles. Your task is to analyze them and come up with a customer retention strategy.</div><div class="paragraph">You should:</div><ul><li>Learn to predict the probability of churn (for the upcoming month) for each customer</li><li>Draw up typical user portraits: select the most outstanding groups and describe their main features</li><li>Analyze the factors that impact churn most</li><li>Draw basic conclusions and develop recommendations on how to improve customer service:
  <ul><li>Identify target groups</li><li>Suggest measures to cut churn</li><li>Describe any other patterns you see with respect to interaction with customers</li></ul></li></ul><h2>Instructions for completing the project</h2><h3>Step 1. Download the data</h3><div class="paragraph">Model Fitness provided you with CSV files containing data on churn for a given month and information on the month preceding it. The dataset includes the following fields:</div><ul><li><code class="code-inline code-inline_theme_light">'Churn'</code> — the fact of churn for the month in question</li><li>Current dataset fields:
  <ul><li>User data for the preceding month
  <ul><li><code class="code-inline code-inline_theme_light">'gender'</code></li><li><code class="code-inline code-inline_theme_light">'Near_Location'</code> — whether the user lives or works in the neighborhood where the gym is located</li><li><code class="code-inline code-inline_theme_light">'Partner'</code> — whether the user is an employee of a partner company (the gym has partner companies whose employees get discounts; in those cases the gym stores information on customers' employers)</li><li><code class="code-inline code-inline_theme_light">Promo_friends</code> — whether the user originally signed up through a "bring a friend" offer (they used a friend's promo code when paying for their first membership)</li><li><code class="code-inline code-inline_theme_light">'Phone'</code> — whether the user provided their phone number</li><li><code class="code-inline code-inline_theme_light">'Age'</code></li><li><code class="code-inline code-inline_theme_light">'Lifetime'</code> — the time (in months) since the customer first came to the gym</li></ul></li></ul></li><li>Data from the log of visits and purchases and data on current membership status
  <ul><li><code class="code-inline code-inline_theme_light">'Contract_period'</code> — 1 month, 3 months, 6 months, or 1 year</li><li><code class="code-inline code-inline_theme_light">'Month_to_end_contract'</code> — the months remaining until the contract expires</li><li><code class="code-inline code-inline_theme_light">'Group_visits'</code> — whether the user takes part in group sessions</li><li><code class="code-inline code-inline_theme_light">'Avg_class_frequency_total'</code> — average frequency of visits per week over the customer's lifetime</li><li><code class="code-inline code-inline_theme_light">'Avg_class_frequency_current_month'</code> — average frequency of visits per week over the preceding month</li><li><code class="code-inline code-inline_theme_light">'Avg_additional_charges_total'</code> — the total amount of money spent on other gym services: cafe, athletic goods, cosmetics, massages, etc.</li></ul></li></ul><div class="paragraph">File path: <code class="code-inline code-inline_theme_light">/datasets/gym_churn_us.csv</code>. <a href="https://code.s3.yandex.net/datasets/gym_churn_us.csv" target="_blank">Download the dataset</a>. </div><h3>Step 2. Carry out exploratory data analysis (EDA)</h3><ul><li>Look at the dataset: does it contain any missing features? Study the mean values and standard deviation (use the <code class="code-inline code-inline_theme_light">describe()</code> method).</li><li>Look at the mean feature values in two groups: for those who left (churn) and for those who stayed (use the <code class="code-inline code-inline_theme_light">groupby()</code> method).</li><li>Plot bar histograms and feature distributions for those who left (churn) and those who stayed.</li><li>Build a correlation matrix and display it.</li></ul><h3>Step 3. Build a model to predict user churn</h3><div class="paragraph">Build a binary classification model for customers where the target feature is the user's leaving next month.</div><ul><li>Divide the data into train and validation sets using the <code class="code-inline code-inline_theme_light">train_test_split()</code> function.</li><li>Train the model on the train set with two methods:
  <ul><li>logistic regression</li><li>random forest</li></ul></li><li>Evaluate accuracy, precision, and recall for both models using the validation data. Use them to compare the models. Which model gave better results?</li></ul><div class="paragraph">Remember to indicate the <code class="code-inline code-inline_theme_light">random_state</code> parameter when dividing data and defining the algorithm. </div><h3>Step 4. Create user clusters</h3><div class="paragraph">Set aside the column with data on churn and identify object (user) clusters: </div><ul><li>Standardize the data.</li><li>Use the <code class="code-inline code-inline_theme_light">linkage()</code> function to build a matrix of distances based on the standardized feature matrix and plot a dendrogram. Note: rendering the dendrogram may take time! Use the resulting graph to estimate the number of clusters you can single out.</li><li>Train the clustering model with the K-means algorithm and predict customer clusters. (Let the number of clusters be <code class="code-inline code-inline_theme_light">n=5</code>, so that it'll be easier to compare your results with those of other students. However, in real life, no one will give you such hints, so you'll have to decide based on the graph from the previous step.)</li><li>Look at the mean feature values for clusters. Does anything catch your eye?</li><li>Plot distributions of features for the clusters. Do you notice anything?</li><li>Calculate the churn rate for each cluster (use the <code class="code-inline code-inline_theme_light">groupby()</code> method). Do they differ in terms of churn rate? Which clusters are prone to leaving, and which are loyal?</li></ul><h3>Step 5. Come up with conclusions and basic recommendations on working with customers</h3><div class="paragraph">Draw conclusions and formulate recommendations regarding the strategy for customer interaction and retention.  </div><div class="paragraph">You don't need to go into detail. Three or four essential principles and examples of their implementation in the form of specific marketing steps will do.</div>
